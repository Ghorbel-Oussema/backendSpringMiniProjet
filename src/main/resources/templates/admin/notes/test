Fonctionnalit√©	Statut
S√©curit√© Spring Security	‚ùå (non bloquant)
Statistiques	‚ùå (bonus)
PDF	‚ùå (bonus)
Notifications	‚ùå (optionnel)
API REST	‚ùå (CSR, pas SSR)

seance fih ama salle et ama cours( ely bech y9ari fih foramteur (ely 3andou specilatie )) w ama groupe (ely fih lista te3 etudent(ely teba3 ama groupe))

donnc effacer le formateur id dans groupe 
et ajouter groupe id dans seance 

A) Mon profil

Voir mon profil (nom, email, sp√©cialit√©)

Modifier mon profil (nom, sp√©cialit√© si tu autorises)

B) Mes cours

Liste des cours du formateur

D√©tails d‚Äôun cours : description + sp√©cialit√© du formateur + (optionnel) groupes concern√©s via s√©ances

Voir les s√©ances li√©es √† un cours

C) Mon planning (calendrier)

Voir planning (toutes les s√©ances de ses cours) filtr√© par date (from/to)

Filtre par cours / salle / groupe

T√©l√©charger planning PDF (plus tard, comme √©tudiant)

D) Gestion des notes (c≈ìur du formateur)

Choisir un cours ‚Üí voir groupes concern√©s

Choisir groupe + cours ‚Üí liste des √©tudiants du groupe

Saisir / modifier les notes (par √©tudiant) pour un cours

Voir notes d√©j√† saisies (pr√©-remplissage)

Option : saisir notes ‚Äúpar s√©ance‚Äù (si tu veux une √©valuation par s√©ance)

E) Statistiques rapides (optionnel mais cool)

Moyenne par groupe pour un cours

Moyenne par cours

√âtudiants en difficult√© (<10 par ex)

Export notes (CSV/PDF) (plus tard)
package com.example.MiniProjetBackend.config;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.authentication.AuthenticationManager;
import org.springframework.security.config.annotation.authentication.configuration.AuthenticationConfiguration;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.config.http.SessionCreationPolicy;
import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;
import org.springframework.security.crypto.password.PasswordEncoder;
import org.springframework.security.web.SecurityFilterChain;
import org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter;
import org.springframework.web.cors.CorsConfiguration;
import org.springframework.web.cors.CorsConfigurationSource;
import org.springframework.web.cors.UrlBasedCorsConfigurationSource;

import com.example.MiniProjetBackend.security.JwtFilter;

@Configuration
@EnableWebSecurity
public class SecurityConfig {

    private final JwtFilter jwtFilter;

    public SecurityConfig(JwtFilter jwtFilter) {
        this.jwtFilter = jwtFilter;
    }

    @Bean
    PasswordEncoder passwordEncoder() {
        return new BCryptPasswordEncoder();
    }

    // üîë pour AuthController (login REST)
    @Bean
    AuthenticationManager authenticationManager(
            AuthenticationConfiguration config) throws Exception {
        return config.getAuthenticationManager();
    }
    @Bean
    CorsConfigurationSource corsConfigurationSource() {
        CorsConfiguration config = new CorsConfiguration();
        config.setAllowCredentials(false);
        config.addAllowedOrigin("http://localhost:4200");
        config.addAllowedHeader("*");
        config.addAllowedMethod("*");

        UrlBasedCorsConfigurationSource source =
                new UrlBasedCorsConfigurationSource();
        source.registerCorsConfiguration("/**", config);
        return source;
    }


    @Bean
    SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {

        http
            // ‚úÖ CORS (OBLIGATOIRE POUR ANGULAR)
            .cors(cors -> {}) 

            // ‚úÖ CSRF OFF pour REST
            .csrf(csrf -> csrf.disable())

            // ‚úÖ SESSION (SSR uniquement)
            .sessionManagement(session ->
                session.sessionCreationPolicy(SessionCreationPolicy.IF_REQUIRED)
            )

            // ‚úÖ AUTH RULES
            .authorizeHttpRequests(auth -> auth

                .requestMatchers(
                    "/login",
                    "/register",
                    "/css/**",
                    "/js/**",
                    "/api/auth/**"
                ).permitAll()

                .requestMatchers("/admin/**").hasRole("ADMIN")
                .requestMatchers("/api/admin/**").hasRole("ADMIN")
                .requestMatchers("/api/**").authenticated()

                .anyRequest().authenticated()
            )

            // ‚úÖ FORM LOGIN (SSR)
            .formLogin(form -> form
                .loginPage("/login")
                .defaultSuccessUrl("/admin", true)
                .permitAll()
            )

            // ‚úÖ LOGOUT SSR
            .logout(logout -> logout
                .logoutUrl("/logout")
                .logoutSuccessUrl("/login?logout")
                .invalidateHttpSession(true)
                .deleteCookies("JSESSIONID")
            );

        // ‚úÖ JWT FILTER
        http.addFilterBefore(jwtFilter, UsernamePasswordAuthenticationFilter.class);

        return http.build();
    }

}

